<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Hello React</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>

    <!-- babel => compilation du JSX -->
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <style>
        .app__counter {
            margin: 1rem;
        }

        button {
            margin-left: 0.5rem;
        }
    </style>
</head>

<body>
    <div id="root"></div>
    <script type="text/babel">
        const CONTAINER = document.getElementById('root');
        const SECOND = 1000;
        const MAX_COUNTER = 5;

        const App = () => {
            return (
                <div>
                    <Button />
                    <Button />
                </div>
            )
        }

        const Button = (props) => {
            const [count, setCount] = React.useState(0);
            const [message, setMessage] = React.useState("");
            const [disabled, setDisabled] = React.useState(false);

            // variable liÃ© au composant
            const interval = React.useRef(null);

            React.useEffect(() => {

                if (count >= MAX_COUNTER) {
                    clearInterval(interval.current);
                    setDisabled(false);
                }

            }, [count]);

            const start = () => {
                if(count >= MAX_COUNTER){

                    setMessage("Vous avez atteint la limite");

                    return;
                }
                setDisabled(true);
                interval.current = setInterval(() => {
                    setCount(count => count + 1);
                }, SECOND);
            }

            const stop = () => {
                setDisabled(false);
                clearInterval(interval.current);
            }

            return (
                <div>
                    { message && <p>{message}</p>}
                    <p>{count}</p>
                    <button disabled={disabled} onClick={start} >Start</button>
                    <button disabled={!disabled} onClick={stop} >Stop</button>
                </div>
            )
        }

        ReactDOM.render(<App />, CONTAINER);
    </script>
</body>

</html>